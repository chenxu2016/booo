!function(e){"use strict";function t(){this.arr="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",this.arrLen=this.arr.length}function n(){if(r.info.isNative){var e=u.getPtpCnt();p.logAppPevent(e)}else{var t=i.getValue(d.pEventId);p.logData("p",t,c),d.EnableLogMoGuJs&&p.sendLog(d.LogMoGuJsUrl,c)}}var r=e.logger={};r.version="0.1.3","undefined"==typeof console&&(window.console={log:function(){}});var o="**logger.js---打点出错:",i={getIEVersion:function(){var e,t=-1,n=navigator.userAgent;return"Microsoft Internet Explorer"==navigator.appName?(e=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})"),null!==e.exec(n)&&(t=parseFloat(RegExp.$1))):"Netscape"==navigator.appName&&(e=new RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})"),null!==e.exec(n)&&(t=parseFloat(RegExp.$1))),t},stringify:function(e){if("undefined"!=typeof JSON)return JSON.stringify(e);var t=typeof e;if("object"!=t||null===e)return"string"==t&&(e='"'+e+'"'),String(e);var n,r,o=[],a=e&&e.constructor==Array;for(n in e)r=e[n],t=typeof r,e.hasOwnProperty(n)&&("string"==t?r='"'+r+'"':"object"==t&&null!==r&&(r=i.stringify(r)),o.push((a?"":'"'+n+'":')+String(r)));return(a?"[":"{")+String(o)+(a?"]":"}")},isArray:function(e){return"[object Array]"==Object.prototype.toString.call(e)},getCookieInArray:function(e){for(var t=0,n=e.length;n>t;t++){var r=i.getCookie(e[t]);if(r)return r}return""},getCookieOrFunc:function(e){return"function"==typeof e?i.getValue(e):i.getCookie(e)},getCookie:function(e){if(i.isArray(e))return i.getCookieInArray(e);var t=document.cookie.match(new RegExp("(^| )"+e+"=([^;]*)(;|$)"));return null!==t?decodeURIComponent(t[2]):""},getQuery:function(e,t){void 0===t&&(t=location.href);var n="(^|&|\\?)"+e+"=([^&]*)(&|$)",r=new RegExp(n,"i"),o=t.substr(1).match(r);return null!==o?decodeURIComponent(o[2]):""},getTime:function(){return parseInt((new Date).getTime()/1e3)},registerEvent:function(e,t,n){window.attachEvent?e.attachEvent("on"+t,n):e.addEventListener(t,n,!1)},extend:function(){for(var e=arguments,t=arguments[0],n=1;n<e.length;n++){var r=e[n];for(var o in r)r.hasOwnProperty(o)&&(t[o]=r[o])}return t},getValue:function(e){if(e){if("function"==typeof e)try{var t=Array.prototype.slice.call(arguments,1);return e.apply(null,t)}catch(n){return console.log(o+n),""}return e}}};r.util=i;var a="https:"===location.protocol?"https:":"http:";r.config={EnableLogMoGuJs:!0,LogUrl:a+"//log.juangua.com/log.php",LogMoGuJsUrl:a+"//log.juangua.com/mogu.js",uuid:["__mgjuuid","__xduuid"],uid:"__ud_",sfrom:"from_site",cpsinfo:"__cpsinfo",ptp_cnt_a:"",ptp_cnt_b:"",ptp_cnt_c_d:"",platform:"",pEventId:"1001",isMobileRe:/iphone|android|ipad/i,ptpRe:/[a-z0-9]+\.[a-z0-9]+\.[a-z0-9]+\.[a-z0-9]+\.[a-z0-9]+/i,hrefRe:/http[s]?:\/\/\w+\.(mogujie|xiaodian|uniny)\.com([\/]|\/.*|)$/,mgjRe:/mgj:\/\//,mtRe:/\?.*[&]?mt=([^\.]+)\.([^\.]+)\.([^\.&#]+)/,chasing:["f","f2"],urlExtend:["acm"],extra:{},isNativeRe:/mogujie(?!nonative)/i,nativeLog:{}},window.PTP_PARAMS&&i.extend(r.config,PTP_PARAMS),t.prototype={rand:function(e){var t,n="";for(t=0;e>t;t++)n+=this.arr.charAt(Math.random()*this.arrLen);return n},code:function(e,t){var n,r=0,o=e.split("");for(n=0;n<o.length;n++)r=t*r+o[n].charCodeAt(0);return Math.abs(r)},hash:function(e,t,n){if(!e||1>n)return"";for(var r=this.code(e,t),o="",i=0,a=0;o.length<n&&(i=r/this.arr.length,a=r%this.arr.length,o+=this.arr.charAt(a),0!==i);)r=i;return o.toString()},pageHash:function(e){return this.hash(e,31,4)+this.hash(e,33,4)}},function(){var e=r.config,t=navigator.userAgent.toLocaleLowerCase();r.info={isApp:e.isNativeRe.test(t),isNative:e.isNativeRe.test(t),isMobile:e.isMobileRe.test(t),isIos:t.indexOf("iphone")>-1,isAndroid:t.indexOf("android")>-1,isXd:location.href.indexOf(".xiaodian.")>-1}}(),function(){function e(){var e=i.getValue(g.ptp_cnt_a);if(e)return e;var t="1";return s.isXd&&(t="xd1"),s.isMobile&&(t="m1"),s.isIos&&s.isNative?t="am0":s.isAndroid&&s.isNative&&(t="am1"),t}function n(){var e=i.getValue(g.ptp_cnt_b);if(e)return e;var t="",n=location.href.replace(":","");return n=n.replace(/[\/\.]/,"_"),t=l.pageHash(n)}function o(){var e=i.getCookieOrFunc(g.cpsinfo);if(e)return e=e.replace("-",",")}function a(){var e=i.getValue(g.platform);return e?e:s.isMobile?32:31}function u(e){if(e){var t=i.getValue(g.ptp_cnt_c_d,e);if(t)return t;var n=e.getAttribute("data-ptp-customc");if(n)return{c:n,d:$('[data-ptp-customc="'+n+'"]').index($(e))+1};if(e=$(e).parents("[data-ptp-customc]")[0])return n=e.getAttribute("data-ptp-customc"),n?{c:n,d:$('[data-ptp-customc="'+n+'"]').index($(e))+1}:void 0}}function c(){-1!=location.protocol.indexOf("file:")&&document.addEventListener("deviceready",function(){window.hybrid&&hybrid.bundle&&hybrid.bundle.getUrl&&hybrid.bundle.getUrl(function(e){v&&(v.refer=e)})},!1)}function d(){return c(),{time:i.getTime(),sfrom:i.getCookieOrFunc(g.sfrom),uuid:i.getCookieOrFunc(g.uuid),uid:i.getCookieOrFunc(g.uid),cpsinfo:o()||"",refer:location.href,rerefer:document.referrer,ptp_url:i.getQuery("ptp",location.search),ptp_ref:i.getQuery("ptp",document.referrer)}}function p(){return{a:e(),b:n(),c:0,d:0,e:l.rand(5)}}var f,g=r.config,s=r.info,l=new t,v=d(),m=p();r.ptp=f={getPtpByType:function(e,t){var n=a(),o=[v.time,0,"p/e",n,r.version,"1001",v.uuid,v.uid,v.refer,v.rerefer];return"p"==e?(t=t||"1001",o[2]="p",o[5]=t,o):"e"==e?(t=t||"50001",o[2]="e",o[5]=t,o):void 0},getPtpCnt:function(e,t){return e||(e=m.c),t||(t=m.d),[m.a,m.b,e,t,m.e].join(".")},getPtpInfo:function(){var e={};return i.extend(e,v,{ptp_cnt:f.getPtpCnt()})},getPtpInfoAndExtra:function(){var e=f.getPtpInfo(),t={};if(g.extra)for(var n in g.extra)g.extra.hasOwnProperty(n)&&(t[n]=i.getValue(g.extra[n]));return i.extend(e,t)},createPtpCnt:function(e){var t=u(e),n="",r="",o=0,i=0;if(t)return f.getPtpCnt(t.c,t.d);if(e&&e.href&&(n=e.href.match(g.mtRe)),n&&(r="_mt-"+n[2]+"-"+n[3]),r)o=r;else{var a=$(e).parents("[data-ptp]");if(a.length){o=a.attr("data-ptp");var c=a.find(".data-ptp-item");i=c.length?c.index($(e).parents(".data-ptp-item"))+1:a.find("a").index($(e))+1}}return i||(i=0),f.getPtpCnt(o,i)},makeUrl:function(e,t,n){var r=e.match(/(#.+)$/);e=e.replace(/(#.+)$/,""),e=e.replace(/ptp=[^&#]*/,""),e+=e.indexOf("?")>-1?"&"+t:"?"+t,e=e.replace(/[&]{2,}/g,"&").replace(/&$/,""),e=e.replace(/\?&/g,"?");var o=f.getChasingParams(e),i=f.getExtendParams(n);return o&&(e+="&"+o),i&&(e+="&"+i),r&&(e+=r[1]),e},getChasingParams:function(e){if(void 0===e&&(e=""),!g.chasing)return"";g.chasing.length||(g.chasing=[g.chasing]);for(var t,n,r,o=[],a=0,u=g.chasing.length;u>a;a++)t=g.chasing[a],r=i.getQuery(t,e),n=i.getQuery(t),n&&!r&&o.push(t+"="+n);return o.join("&")},getExtendParams:function(e){if(!e||!$(e).is("a"))return"";for(var t=[],n=g.urlExtend||[],r=0,o=n.length;o>r;r++){var i=n[r],a=$(e).attr("data-ext-"+i);a&&t.push(i+"="+encodeURIComponent(a))}return t.join("&")},refreshPtp:function(){v=d(),m=p()}}}(),function(){var e=r.info,t=r.ptp,n=r.config,a=0,u=function(e,t){t=t||{};var n=[];for(var r in t){var o=t[r];o||(o=""),o=encodeURIComponent(o),n.push(r+"="+o)}n=n.join("&"),e=e.indexOf("?")>-1?e+"&"+n:e+"?"+n;var i=new Image;i.src=e},c=function(e,t){t=t||{};var n,r=a++;try{n=document.createElement('<iframe name="'+r+'">')}catch(u){n=document.createElement("iframe"),n.setAttribute("name",r)}try{n.style.display="none",document.body.appendChild(n),n.contentWindow.name=r;var c=document.createElement("form");c.setAttribute("method","POST"),c.setAttribute("action",e),c.setAttribute("target",r);for(var d in t)if(t.hasOwnProperty(d)){var p=document.createElement("input");p.setAttribute("type","hidden"),p.setAttribute("name",d),p.setAttribute("value",t[d]),c.appendChild(p)}document.body.appendChild(c),c.submit(),i.registerEvent(n,"load",function(){try{document.body.removeChild(c),document.body.removeChild(n)}catch(e){}})}catch(u){console.log(o+u)}},d={sendLog:function(e,t){var n=-1!=i.getIEVersion();n?c(e,t):u(e,t)},sendAppLog:function(e,t){return e+="",n.nativeLog&&n.nativeLog.logE?n.nativeLog.logE(e,t):void(window.hdp&&window.hdp["do"]?hdp["do"]("mgj.tracker.sendEvent",e,t):document.addEventListener("deviceready",function(){window.mgj&&mgj.tracker&&mgj.tracker.sendEvent&&mgj.tracker.sendEvent(e,t)},!1))},logAppPevent:function(e){return n.nativeLog&&n.nativeLog.logP?n.nativeLog.logP(e):void(window.hdp&&window.hdp["do"]?hdp["do"]("mgj.pevent",e).then(function(){},function(e){console.log("pevent:"+e)}):document.addEventListener("deviceready",function(){window.mgj&&mgj.pevent&&mgj.pevent(function(){},null,e)},!1))},logData:function(r,o,a){var u=t.getPtpByType(r,o);u.push(i.stringify(a)),e.isNative?d.sendAppLog(o,a):d.sendLog(n.LogUrl,{v:1,data:u.join("	")})}};r.send=d}(),function(){function e(e){var t=e.href;if(!(t.indexOf("mogujie.com/mtalk/")>-1)&&(n.hrefRe.test(t)||n.mgjRe.test(t))){var r=e.getAttribute("data-ptp-cache-id");t=e.getAttribute("href"),r&&n.ptpRe.test(r)||(r=o.createPtpCnt(e),e.setAttribute("data-ptp-cache-id",r)),e.href=o.makeUrl(t,"ptp="+r,e)}}function t(t){var n=t||window.event,r=n.target||n.srcElement,o="A"===r.nodeName?r:$(r).parents("a")[0],i="AREA"===r.nodeName?r:null;i&&(o=i),o&&(o.href&&o.href.indexOf("javascript:")>-1||e(o))}var n=r.config,o=r.ptp,a="tap"in document.createElement("div")?"tap":"mousedown";i.registerEvent(document,a,t),i.registerEvent(document,"touchstart",t)}();var u=r.ptp,c=u.getPtpInfoAndExtra(),d=r.config,p=r.send;n(),r.refreshPevent=function(){r.ptp.refreshPtp(),c=r.ptp.getPtpInfoAndExtra(),n()},r.log=function(e,t){void 0!==e&&(t=t||{},r.send.logData("e",e,i.extend({},c,t)))},r.generatePtpParams=function(e,t){if(void 0!==e){var n="";return n=t?u.createPtpCnt(t):u.getPtpCnt(),u.makeUrl(e,"ptp="+n,t)}},"undefined"!=typeof module&&"object"==typeof exports?module.exports=r:"function"==typeof define&&(define.amd||define.cmd)&&define("logger",function(){return r})}(window);